"use strict";(()=>{var e={};e.id=2082,e.ids=[2082],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},48395:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>I,originalPathname:()=>j,patchFetch:()=>q,requestAsyncStorage:()=>g,routeModule:()=>y,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>P});var a={};r.r(a),r.d(a,{GET:()=>l,POST:()=>d,dynamic:()=>i});var s=r(10884),o=r(16132),n=r(21040),u=r(27342),c=r(95798);let i="force-dynamic";async function d(e){try{let{userId:t,products:r,total:a,address:s}=await e.json();if(p(r),!m(s))return c.Z.json({success:!1,error:"Bad Request"},{status:400});let o=await u.Z.order.create({data:{userId:t,total:a,address:{create:s},orderItem:{createMany:{data:r.map(e=>({productId:e.productId,quantity:e.quantity,total:e.total,title:e.title,desc:e.desc,price:e.price,discount:e.discount,category:e.category,subCategory:e.subCategory,color:e.color,stock:e.stock,images:e.images}))}},shippingStatus:"PENDING"},include:{address:!0,returnInfo:!0,orderItem:!0}});return c.Z.json({success:!0,data:o},{status:201})}catch(e){return console.log(e),c.Z.json({success:!1,error:e.message},{status:501})}}async function l(e){try{let t=new URL(e.nextUrl.href),r=t.searchParams.get("id"),a=await u.Z.order.findMany({where:{userId:r},orderBy:{createdAt:"desc"},include:{address:!0,returnInfo:!0,orderItem:!0}});return c.Z.json({success:!0,data:a},{status:200})}catch(e){return console.log(e),c.Z.json({success:!1,error:e.message},{status:501})}}let p=e=>e&&e.productId&&""!==e.productId.trim()&&e.quantity&&""!==e.quantity.trim()&&e.total&&""!==e.total.trim(),m=e=>e&&e.street&&e.city&&e.state&&e.postalCode&&e.country,y=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/(user)/order/route",pathname:"/api/order",filename:"route",bundlePath:"app/api/(user)/order/route"},resolvedPagePath:"/workspaces/bunkar_banaras/app/api/(user)/order/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:f,headerHooks:I,staticGenerationBailout:P}=y,j="/api/(user)/order/route";function q(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}},27342:(e,t,r)=>{let a;r.d(t,{Z:()=>o});let s=require("@prisma/client");a=new s.PrismaClient;let o=a}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[3271,8107],()=>r(48395));module.exports=a})();