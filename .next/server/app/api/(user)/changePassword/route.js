"use strict";(()=>{var e={};e.id=9401,e.ids=[9401],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},87942:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>w,originalPathname:()=>P,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>k});var a={};s.r(a),s.d(a,{POST:()=>d,dynamic:()=>p});var t=s(10884),n=s(16132),o=s(21040),i=s(51601),u=s(95798);let c=s(62421),p="force-dynamic";async function d(e){try{let r=new URL(e.nextUrl.href),s=r.searchParams.get("token"),{password:a}=await e.json(),t=await (0,i.verifyresetLinkToken)(s),n=c.hashSync(a,8);return await prisma.user.update({where:{id:t.payload.id},data:{password:n}}),u.Z.json({success:!0},{status:201})}catch(e){return console.log(e),u.Z.json({success:!1,error:e.message},{status:501})}}let m=new t.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/(user)/changePassword/route",pathname:"/api/changePassword",filename:"route",bundlePath:"app/api/(user)/changePassword/route"},resolvedPagePath:"/workspaces/bunkar_banaras/app/api/(user)/changePassword/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:l,serverHooks:g,headerHooks:w,staticGenerationBailout:k}=m,P="/api/(user)/changePassword/route";function f(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:l})}},51601:(e,r,s)=>{let a=s(96721),t=process.env.ACCESS_TOKEN_SECRET,n=process.env.ACCESS_TOKEN_SECRET;e.exports={signAccessToken:e=>new Promise((r,s)=>{a.sign({payload:e},t,{},(e,a)=>{e&&s(e),r(a)})}),verifyAccessToken:e=>new Promise((r,s)=>{a.verify(e,t,(e,a)=>{if(e){let r="JsonWebTokenError"==e.name?"Unauthorized":e.message;return s(r)}r(a)})}),resetLinkToken:e=>new Promise((r,s)=>{a.sign({payload:e},n,{expiresIn:"5m"},(e,a)=>{e&&s(e),r(a)})}),verifyresetLinkToken:e=>new Promise((r,s)=>{a.verify(e,n,(e,a)=>{if(e){let r="JsonWebTokenError"==e.name?"Unauthorized":e.message;return s(r)}r(a)})})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),a=r.X(0,[3271,8107,6721,2421],()=>s(87942));module.exports=a})();